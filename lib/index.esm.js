import{jsx as r,Fragment as t}from"react/jsx-runtime";import e from"axios";import{createContext as s,useContext as i,useState as n,useEffect as o}from"react";const c=s({isloading:!0,setUser:()=>null,user:void 0,fetchUser:()=>Promise.resolve()}),a=()=>i(c),l=({children:t,fetchUserUrl:s,refetchOnServerError:i=!1,onError:a})=>{const[l,d]=n(),[u,h]=n(!0),f=async()=>{try{const{status:r,data:t}=await e(s,{withCredentials:!0});200===r&&d(t),h(!1)}catch(r){h(!1);const{code:t}=r;a?.(r),"ERR_NETWORK"===t&&i&&f()}};return o((()=>(f(),()=>{d(void 0),h(!0)})),[]),r(c.Provider,{value:{user:l,setUser:d,isloading:u,fetchUser:f},children:t})},d=()=>{const[r,t]=n(!1),[e,s]=n(),{setUser:i,fetchUser:o}=a();return{signin:r=>u({...r,setSubmissionState:t,fetchUser:o,setError:s}),signout:r=>f({...r,setSubmissionState:t,setUser:i,setError:s}),log:r=>h({...r,setSubmissionState:t,setError:s}),submissionState:r,setSubmissionState:t,error:e}},u=async({credentials:r,setSubmissionState:t,url:s,fetchUser:i,setError:n})=>{try{t?.(!0);const{status:n}=await e(s,{method:"POST",withCredentials:!0,data:r});200===n&&(t?.(!1),await(i?.()))}catch(r){t?.(!1),n?.(r)}},h=async({setSubmissionState:r,setError:t,url:s,...i})=>{try{r?.(!0);const t=await e(s,{...i});if(200===t.status)return r?.(!1),t}catch(e){r?.(!1),t?.(e)}},f=async({url:r,setSubmissionState:t,setUser:s,setError:i})=>{try{t?.(!0);const{status:i}=await e(r,{method:"DELETE",withCredentials:!0});200===i&&(t?.(!1),s?.(void 0))}catch(r){t?.(!1),i?.(r)}},m=({children:e,fallback:s,offline:i})=>{const{isloading:n,user:o}=a();return r(t,n&&!o?{children:s}:n||o?"function"==typeof e&&o?{children:e(o)}:{children:e}:{children:i})},S=({children:e,fallback:s,online:i})=>{const{isloading:n,user:o}=a();return r(t,n&&!o?{children:s}:!n&&o?{children:i}:{children:e})},E=({fallback:e,children:s,redirect:i})=>{const{isloading:n,user:o}=a();return n&&!o?r(t,{children:e}):n||o?r(t,{children:s}):"function"==typeof i?i():i},b=({fallback:e,children:s,redirect:i})=>{const{isloading:n,user:o}=a();return n&&!o?r(t,{children:e}):!n&&o?"function"==typeof i?i():i:r(t,{children:s})};export{S as Offline,m as Online,E as Protected,l as Provider,b as UnProtected,d as useAuthentication,a as useUser};
//# sourceMappingURL=index.esm.js.map
