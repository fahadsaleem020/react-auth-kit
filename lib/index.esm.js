import{jsx as t,Fragment as e}from"react/jsx-runtime";import r from"axios";import{createContext as s,useContext as i,useState as a,useEffect as o}from"react";const n=s({fetchUser:()=>Promise.resolve(),setUser:()=>null,user:void 0,isloading:!0,baseUrl:""}),c=()=>i(n),l=({baseUrl:e,onError:s,children:i,fetchUserFrom:c,refetchOnServerError:l=!1})=>{const[u,d]=a();let h=e?.trim()+c.trim();const[m,U]=a(!0),b=async()=>{console.log(h);try{const{status:t,data:e}=await r(h,{withCredentials:!0});200===t&&d(e),U(!1)}catch(t){U(!1),s?.(t);const{code:e}=t;"ERR_NETWORK"===e&&l&&b()}};return o((()=>(b(),()=>{d(void 0),U(!0)})),[]),t(n.Provider,{value:{user:u,setUser:d,isloading:m,fetchUser:b,baseUrl:e?.trim()},children:i})},u=()=>{const[t,e]=a(!1),{setUser:r,fetchUser:s,baseUrl:i}=c(),[o,n]=a();return{signin:t=>d({setSubmissionState:e,url:"/signin",fetchUser:s,setError:n,baseUrl:i,...t}),signout:t=>m({setSubmissionState:e,url:"/signout",setError:n,setUser:r,baseUrl:i,...t}),signup:t=>h({setSubmissionState:e,setError:n,baseUrl:i,url:"/signup",...t}),verifyemail:t=>U({setSubmissionState:e,url:"/verify",setError:n,baseUrl:i,...t}),setSubmissionState:e,submissionState:t,error:o}},d=async({setSubmissionState:t,credentials:e,fetchUser:s,setError:i,baseUrl:a,url:o})=>{try{t?.(!0);const{status:n}=await r(a+o,{withCredentials:!0,data:e,method:"POST"});200===n&&(t?.(!1),i?.(void 0),await(s?.()))}catch(e){t?.(!1),i?.(e)}},h=async({setSubmissionState:t,credentials:e,setError:s,baseUrl:i,url:a})=>{try{t?.(!0);const o=await r(i+a,{withCredentials:!0,data:e,method:"POST"});if(200===o.status)return t?.(!1),s?.(void 0),o}catch(e){t?.(!1),s?.(e)}},m=async({setSubmissionState:t,setError:e,baseUrl:s,setUser:i,url:a})=>{try{t?.(!0);const{status:o}=await r(s+a,{method:"DELETE",withCredentials:!0});200===o&&(t?.(!1),e?.(void 0),i?.(void 0))}catch(r){t?.(!1),e?.(r)}},U=async({setSubmissionState:t,authenticate:e,credentials:s,fetchUser:i,setError:a,baseUrl:o,method:n,url:c})=>{const l="PUT"===n?o+c:o+c+"/:code";try{t?.(!0);const{status:o}=await r(l,{withCredentials:!0,data:s,method:n});200===o&&(t?.(!1),a?.(void 0),e&&await(i?.()))}catch(e){t?.(!1),a?.(e)}},b=({fallback:r="loading...",children:s,offline:i})=>{const{isloading:a,user:o}=c();return a&&!o?t(e,{children:r}):a||o?t(e,"function"==typeof s&&o?{children:s(o)}:{children:s}):"function"==typeof i?i():i},f=({fallback:r="loading...",children:s,online:i})=>{const{isloading:a,user:o}=c();return a&&!o?t(e,{children:r}):!a&&o?"function"==typeof i?i(o):i:t(e,{children:s})};export{f as Offline,b as Online,l as UserProvider,u as useAuthentication,c as useUser};
//# sourceMappingURL=index.esm.js.map
