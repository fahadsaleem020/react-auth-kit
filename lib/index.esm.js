import{jsx as t,Fragment as e}from"react/jsx-runtime";import r from"axios";import{createContext as s,useContext as i,useState as a,useEffect as n}from"react";const o=s({fetchUser:()=>Promise.resolve(),setUser:()=>null,user:void 0,isloading:!0,baseUrl:""}),c=()=>i(o),l=({baseUrl:e,onError:s,children:i,fetchUserFrom:c,refetchOnServerError:l=!1})=>{const[d,u]=a();let h=e?.trim()+"/"+c.trim();const[m,f]=a(!0),U=async()=>{try{const{status:t,data:e}=await r(h,{withCredentials:!0});200===t&&u(e),f(!1)}catch(t){f(!1),s?.(t);const{code:e}=t;"ERR_NETWORK"===e&&l&&U()}};return n((()=>(U(),()=>{u(void 0),f(!0)})),[]),t(o.Provider,{value:{user:d,setUser:u,isloading:m,fetchUser:U,baseUrl:e?.trim()},children:i})},d=()=>{const[t,e]=a(!1),[r,s]=a(),{setUser:i,fetchUser:n,baseUrl:o}=c();return{signin:t=>u({...t,setSubmissionState:e,fetchUser:n,setError:s,baseUrl:o}),signout:t=>m({...t,setSubmissionState:e,setUser:i,setError:s,baseUrl:o}),signup:t=>h({...t,setSubmissionState:e,setError:s,baseUrl:o}),submissionState:t,setSubmissionState:e,error:r}},u=async({setSubmissionState:t,credentials:e,fetchUser:s,setError:i,baseUrl:a,url:n})=>{try{t?.(!0);const{status:i}=await r(a+n,{withCredentials:!0,data:e,method:"POST"});200===i&&(t?.(!1),await(s?.()))}catch(e){t?.(!1),i?.(e)}},h=async({setSubmissionState:t,credentials:e,setError:s,baseUrl:i,url:a})=>{try{t?.(!0);const s=await r(i+a,{withCredentials:!0,data:e,method:"POST"});if(200===s.status)return t?.(!1),s}catch(e){t?.(!1),s?.(e)}},m=async({setSubmissionState:t,setError:e,setUser:s,baseUrl:i,url:a})=>{try{t?.(!0);const{status:e}=await r(i+a,{method:"DELETE",withCredentials:!0});200===e&&(t?.(!1),s?.(void 0))}catch(r){t?.(!1),e?.(r)}},f=({fallback:r="loading...",children:s,offline:i})=>{const{isloading:a,user:n}=c();return a&&!n?t(e,{children:r}):a||n?t(e,"function"==typeof s&&n?{children:s(n)}:{children:s}):"function"==typeof i?i():i},U=({fallback:r="loading...",children:s,online:i})=>{const{isloading:a,user:n}=c();return a&&!n?t(e,{children:r}):!a&&n?"function"==typeof i?i(n):i:t(e,{children:s})};export{U as Offline,f as Online,l as Provider,d as useAuthentication,c as useUser};
//# sourceMappingURL=index.esm.js.map
